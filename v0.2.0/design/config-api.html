
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Configuration API Design &#8212; Envoy Gateway  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer Docs" href="../dev_docs.html" />
    <link rel="prev" title="Watching Components Design" href="watching.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="configuration-api-design">
<h1>Configuration API Design<a class="headerlink" href="#configuration-api-design" title="Permalink to this heading">¶</a></h1>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/gateway/issues/51">Issue 51</a> specifies the need to design an API for configuring Envoy Gateway. The control plane is configured
statically at startup and the data plane is configured dynamically through Kubernetes resources, primarily
<a class="reference external" href="https://gateway-api.sigs.k8s.io/">Gateway API</a> objects. Refer to the Envoy Gateway <a class="reference external" href="https://github.com/envoyproxy/gateway/blob/main/docs/design/SYSTEM_DESIGN.md">design doc</a> for additional details regarding
Envoy Gateway terminology and configuration.</p>
</section>
<section id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Define an <strong>initial</strong> API to configure Envoy Gateway at startup.</p></li>
<li><p>Define an <strong>initial</strong> API for configuring the managed data plane, e.g. Envoy proxies.</p></li>
</ul>
</section>
<section id="non-goals">
<h2>Non-Goals<a class="headerlink" href="#non-goals" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Implementation of the configuration APIs.</p></li>
<li><p>Define the <code class="docutils literal notranslate"><span class="pre">status</span></code> subresource of the configuration APIs.</p></li>
<li><p>Define a <strong>complete</strong> set of APIs for configuring Envoy Gateway. As stated in the <a class="reference internal" href="#goals"><span class="std std-doc">Goals</span></a>, this document
defines the initial configuration APIs.</p></li>
<li><p>Define an API for deploying/provisioning/operating Envoy Gateway. If needed, a future Envoy Gateway operator would be
responsible for designing and implementing this type of API.</p></li>
<li><p>Specify tooling for managing the API, e.g. generate protos, CRDs, controller RBAC, etc.</p></li>
</ul>
</section>
<section id="control-plane-api">
<h2>Control Plane API<a class="headerlink" href="#control-plane-api" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">EnvoyGateway</span></code> API defines the control plane configuration, e.g. Envoy Gateway. Key points of this API are:</p>
<ul class="simple">
<li><p>It will define Envoy Gateway’s startup configuration file. If the file does not exist, Envoy Gateway will start up
with default configuration parameters.</p></li>
<li><p>EnvoyGateway inlines the <code class="docutils literal notranslate"><span class="pre">TypeMeta</span></code> API. This allows EnvoyGateway to be versioned and managed as a GroupVersionKind
scheme.</p></li>
<li><p>EnvoyGateway does not contain a metadata field since it’s currently represented as a static configuration file instead of
a Kubernetes resource.</p></li>
<li><p>Since EnvoyGateway does not surface status, EnvoyGatewaySpec is inlined.</p></li>
<li><p>If data plane static configuration is required in the future, Envoy Gateway will use a separate file for this purpose.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">v1alpha1</span></code> version and <code class="docutils literal notranslate"><span class="pre">config.gateway.envoyproxy.io</span></code> API group get generated:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// gateway/api/config/v1alpha1/doc.go</span>

<span class="c1">// Package v1alpha1 contains API Schema definitions for the config.gateway.envoyproxy.io API group.</span>
<span class="c1">//</span>
<span class="c1">// +groupName=config.gateway.envoyproxy.io</span>
<span class="kn">package</span><span class="w"> </span><span class="nx">v1alpha1</span>
</pre></div>
</div>
<p>The initial <code class="docutils literal notranslate"><span class="pre">EnvoyGateway</span></code> API:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// gateway/api/config/v1alpha1/envoygateway.go</span>

<span class="kn">package</span><span class="w"> </span><span class="nx">valpha1</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">	</span><span class="nx">metav1</span><span class="w"> </span><span class="s">&quot;k8s.io/apimachinery/pkg/apis/meta/v1&quot;</span>
<span class="p">)</span>

<span class="c1">// EnvoyGateway is the Schema for the envoygateways API</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">EnvoyGateway</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">TypeMeta</span><span class="w"> </span><span class="s">`json:&quot;,inline&quot;`</span>

<span class="w">	</span><span class="c1">// EnvoyGatewaySpec defines the desired state of Envoy Gateway.</span>
<span class="w">	</span><span class="nx">EnvoyGatewaySpec</span><span class="w"> </span><span class="s">`json:&quot;,inline&quot;`</span>
<span class="p">}</span>

<span class="c1">// EnvoyGatewaySpec defines the desired state of Envoy Gateway configuration.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">EnvoyGatewaySpec</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Gateway defines Gateway-API specific configuration. If unset, default</span>
<span class="w">	</span><span class="c1">// configuration parameters will apply.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +optional</span>
<span class="w">	</span><span class="nx">Gateway</span><span class="w"> </span><span class="o">*</span><span class="nx">Gateway</span><span class="w"> </span><span class="s">`json:&quot;gateway,omitempty&quot;`</span>

<span class="w">	</span><span class="c1">// Provider defines the desired provider configuration. If unspecified,</span>
<span class="w">	</span><span class="c1">// the Kubernetes provider is used with default parameters.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +optional</span>
<span class="w">	</span><span class="nx">Provider</span><span class="w"> </span><span class="o">*</span><span class="nx">Provider</span><span class="w"> </span><span class="s">`json:&quot;provider,omitempty&quot;`</span>
<span class="p">}</span>

<span class="c1">// Gateway defines desired Gateway API configuration of Envoy Gateway.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Gateway</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// ControllerName defines the name of the Gateway API controller. If unspecified,</span>
<span class="w">	</span><span class="c1">// defaults to &quot;gateway.envoyproxy.io/gatewayclass-controller&quot;. See the following</span>
<span class="w">	</span><span class="c1">// for additional details:</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// https://gateway-api.sigs.k8s.io/v1alpha2/references/spec/#gateway.networking.k8s.io/v1alpha2.GatewayClass</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +optional</span>
<span class="w">	</span><span class="nx">ControllerName</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;controllerName,omitempty&quot;`</span>
<span class="p">}</span>

<span class="c1">// Provider defines the desired configuration of a provider.</span>
<span class="c1">// +union</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">Provider</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Type is the type of provider to use. If unset, the Kubernetes provider is used.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +unionDiscriminator</span>
<span class="w">	</span><span class="nx">Type</span><span class="w"> </span><span class="nx">ProviderType</span><span class="w"> </span><span class="s">`json:&quot;type,omitempty&quot;`</span>
<span class="w">	</span><span class="c1">// Kubernetes defines the configuration of the Kubernetes provider. Kubernetes</span>
<span class="w">	</span><span class="c1">// provides runtime configuration via the Kubernetes API.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +optional</span>
<span class="w">	</span><span class="nx">Kubernetes</span><span class="w"> </span><span class="o">*</span><span class="nx">KubernetesProvider</span><span class="w"> </span><span class="s">`json:&quot;kubernetes,omitempty&quot;`</span>

<span class="w">	</span><span class="c1">// File defines the configuration of the File provider. File provides runtime</span>
<span class="w">	</span><span class="c1">// configuration defined by one or more files.</span>
<span class="w">	</span><span class="c1">//</span>
<span class="w">	</span><span class="c1">// +optional</span>
<span class="w">	</span><span class="nx">File</span><span class="w"> </span><span class="o">*</span><span class="nx">FileProvider</span><span class="w"> </span><span class="s">`json:&quot;file,omitempty&quot;`</span>
<span class="p">}</span>

<span class="c1">// ProviderType defines the types of providers supported by Envoy Gateway.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">ProviderType</span><span class="w"> </span><span class="kt">string</span>

<span class="kd">const</span><span class="w"> </span><span class="p">(</span>
<span class="w">	</span><span class="c1">// KubernetesProviderType defines the &quot;Kubernetes&quot; provider.</span>
<span class="w">	</span><span class="nx">KubernetesProviderType</span><span class="w"> </span><span class="nx">ProviderType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;Kubernetes&quot;</span>

<span class="w">	</span><span class="c1">// FileProviderType defines the &quot;File&quot; provider.</span>
<span class="w">	</span><span class="nx">FileProviderType</span><span class="w"> </span><span class="nx">ProviderType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;File&quot;</span>
<span class="p">)</span>

<span class="c1">// KubernetesProvider defines configuration for the Kubernetes provider.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">KubernetesProvider</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// TODO: Add config as use cases are better understood.</span>
<span class="p">}</span>

<span class="c1">// FileProvider defines configuration for the File provider.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">FileProvider</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// TODO: Add config as use cases are better understood.</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note:</strong> Provider-specific configuration is defined in the <code class="docutils literal notranslate"><span class="pre">{$PROVIDER_NAME}Provider</span></code> API.</p>
<section id="gateway">
<h3>Gateway<a class="headerlink" href="#gateway" title="Permalink to this heading">¶</a></h3>
<p>Gateway defines desired configuration of <a class="reference external" href="https://gateway-api.sigs.k8s.io/">Gateway API</a> controllers that reconcile and translate Gateway API
resources into the Intermediate Representation (IR). Refer to the Envoy Gateway <a class="reference external" href="https://github.com/envoyproxy/gateway/blob/main/docs/design/SYSTEM_DESIGN.md">design doc</a> for additional
details.</p>
</section>
<section id="provider">
<h3>Provider<a class="headerlink" href="#provider" title="Permalink to this heading">¶</a></h3>
<p>Provider defines the desired configuration of an Envoy Gateway provider. A provider is an infrastructure component that
Envoy Gateway calls to establish its runtime configuration. Provider is a <a class="reference external" href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#unions">union type</a>. Therefore, Envoy Gateway
can be configured with only one provider based on the <code class="docutils literal notranslate"><span class="pre">type</span></code> discriminator field. Refer to the Envoy Gateway
<a class="reference external" href="https://github.com/envoyproxy/gateway/blob/main/docs/design/SYSTEM_DESIGN.md">design doc</a> for additional details.</p>
</section>
<section id="control-plane-configuration">
<h3>Control Plane Configuration<a class="headerlink" href="#control-plane-configuration" title="Permalink to this heading">¶</a></h3>
<p>The configuration file is defined by the EnvoyGateway API type. At startup, Envoy Gateway searches for the configuration
at “/etc/envoy-gateway/config.yaml”.</p>
<p>Start Envoy Gateway:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./envoy-gateway
</pre></div>
</div>
<p>Since the configuration file does not exist, Envoy Gateway will start with default configuration parameters.</p>
<p>The Kubernetes provider can be configured explicitly using <code class="docutils literal notranslate"><span class="pre">provider.kubernetes</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ cat &lt;&lt; EOF &gt; /etc/envoy-gateway/config.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyGateway</span>
<span class="nt">provider</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Kubernetes</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="l l-Scalar l-Scalar-Plain">EOF</span>
</pre></div>
</div>
<p>This configuration will cause Envoy Gateway to use the Kubernetes provider with default configuration parameters.</p>
<p>The Kubernetes provider can be configured using the <code class="docutils literal notranslate"><span class="pre">provider</span></code> field. For example, the <code class="docutils literal notranslate"><span class="pre">foo</span></code> field can be set to “bar”:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ cat &lt;&lt; EOF &gt; /etc/envoy-gateway/config.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyGateway</span>
<span class="nt">provider</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Kubernetes</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar</span>
<span class="l l-Scalar l-Scalar-Plain">EOF</span>
</pre></div>
</div>
<p><strong>Note:</strong> The Provider API from the Kubernetes package is currently undefined and <code class="docutils literal notranslate"><span class="pre">foo:</span> <span class="pre">bar</span></code> is provided for
illustration purposes only.</p>
<p>The same API structure is followed for each supported provider. The following example causes Envoy Gateway to use the
File provider:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ cat &lt;&lt; EOF &gt; /etc/envoy-gateway/config.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyGateway</span>
<span class="nt">provider</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">File</span>
<span class="w">  </span><span class="nt">file</span><span class="p">:</span>
<span class="w">    </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar</span>
<span class="l l-Scalar l-Scalar-Plain">EOF</span>
</pre></div>
</div>
<p><strong>Note:</strong> The Provider API from the File package is currently undefined and <code class="docutils literal notranslate"><span class="pre">foo:</span> <span class="pre">bar</span></code> is provided for illustration
purposes only.</p>
<p>Gateway API-related configuration is expressed through the <code class="docutils literal notranslate"><span class="pre">gateway</span></code> field. If unspecified, Envoy Gateway will use
default configuration parameters for <code class="docutils literal notranslate"><span class="pre">gateway</span></code>. The following example causes the <a class="reference external" href="https://gateway-api.sigs.k8s.io/v1alpha2/references/spec/#gateway.networking.k8s.io/v1alpha2.GatewayClass">GatewayClass</a> controller to
manage GatewayClasses with controllerName <code class="docutils literal notranslate"><span class="pre">foo</span></code> instead of the default <code class="docutils literal notranslate"><span class="pre">gateway.envoyproxy.io/gatewayclass-controller</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ cat &lt;&lt; EOF &gt; /etc/envoy-gateway/config.yaml</span>
<span class="l l-Scalar l-Scalar-Plain">apiVersion</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyGateway</span>
<span class="nt">gateway</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controllerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foo</span>
</pre></div>
</div>
<p>With any of the above configuration examples, Envoy Gateway can be started without any additional arguments:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./envoy-gateway
</pre></div>
</div>
</section>
</section>
<section id="data-plane-api">
<h2>Data Plane API<a class="headerlink" href="#data-plane-api" title="Permalink to this heading">¶</a></h2>
<p>The data plane is configured dynamically through Kubernetes resources, primarily <a class="reference external" href="https://gateway-api.sigs.k8s.io/">Gateway API</a> objects.
Optionally, the data plane infrastructure can be configured by referencing a <a class="reference external" href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource (CR)</a> through
<code class="docutils literal notranslate"><span class="pre">spec.parametersRef</span></code> of the managed GatewayClass. The <code class="docutils literal notranslate"><span class="pre">EnvoyProxy</span></code> API defines the data plane infrastructure
configuration and is represented as the CR referenced by the managed GatewayClass. Key points of this API are:</p>
<ul>
<li><p>If unreferenced by <code class="docutils literal notranslate"><span class="pre">gatewayclass.spec.parametersRef</span></code>, default parameters will be used to configure the data plane
infrastructure, e.g. expose Envoy network endpoints using a LoadBalancer service.</p></li>
<li><p>Envoy Gateway will follow Gateway API <a class="reference external" href="https://gateway-api.sigs.k8s.io/v1alpha2/references/spec/#gateway.networking.k8s.io/v1alpha2.GatewayClass">recommendations</a> regarding updates to the EnvoyProxy CR:</p>
<blockquote>
<div><p>It is recommended that this resource be used as a template for Gateways. This means that a Gateway is based on the
state of the GatewayClass at the time it was created and changes to the GatewayClass or associated parameters are
not propagated down to existing Gateways.</p>
</div></blockquote>
</li>
</ul>
<p>The initial <code class="docutils literal notranslate"><span class="pre">EnvoyProxy</span></code> API:</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// gateway/api/config/v1alpha1/envoyproxy.go</span>

<span class="kn">package</span><span class="w"> </span><span class="nx">v1alpha1</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">	</span><span class="nx">metav1</span><span class="w"> </span><span class="s">&quot;k8s.io/apimachinery/pkg/apis/meta/v1&quot;</span>
<span class="p">)</span>

<span class="c1">// EnvoyProxy is the Schema for the envoyproxies API.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">EnvoyProxy</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">TypeMeta</span><span class="w">   </span><span class="s">`json:&quot;,inline&quot;`</span>
<span class="w">	</span><span class="nx">metav1</span><span class="p">.</span><span class="nx">ObjectMeta</span><span class="w"> </span><span class="s">`json:&quot;metadata,omitempty&quot;`</span>

<span class="w">	</span><span class="nx">Spec</span><span class="w">   </span><span class="nx">EnvoyProxySpec</span><span class="w">   </span><span class="s">`json:&quot;spec,omitempty&quot;`</span>
<span class="w">	</span><span class="nx">Status</span><span class="w"> </span><span class="nx">EnvoyProxyStatus</span><span class="w"> </span><span class="s">`json:&quot;status,omitempty&quot;`</span>
<span class="p">}</span>

<span class="c1">// EnvoyProxySpec defines the desired state of Envoy Proxy infrastructure</span>
<span class="c1">// configuration.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">EnvoyProxySpec</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Undefined by this design spec.</span>
<span class="p">}</span>

<span class="c1">// EnvoyProxyStatus defines the observed state of EnvoyProxy.</span>
<span class="kd">type</span><span class="w"> </span><span class="nx">EnvoyProxyStatus</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">	</span><span class="c1">// Undefined by this design spec.</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The EnvoyProxySpec and EnvoyProxyStatus fields will be defined in the future as proxy infrastructure configuration use
cases are better understood.</p>
<section id="data-plane-configuration">
<h3>Data Plane Configuration<a class="headerlink" href="#data-plane-configuration" title="Permalink to this heading">¶</a></h3>
<p>GatewayClass and Gateway resources define the data plane infrastructure. Note that all examples assume Envoy Gateway is
running with the Kubernetes provider.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GatewayClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-class</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controllerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.envoyproxy.io/gatewayclass-controller</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gateway</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gatewayClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-class</span>
<span class="w">  </span><span class="nt">listeners</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">    </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</pre></div>
</div>
<p>Since the GatewayClass does not define <code class="docutils literal notranslate"><span class="pre">spec.parametersRef</span></code>, the data plane is provisioned using default configuration
parameters. The Envoy proxies will be configured with a http listener and a Kubernetes LoadBalancer service listening
on port 80.</p>
<p>The following example will configure the data plane to use a ClusterIP service instead of the default LoadBalancer
service:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GatewayClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-class</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controllerName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.envoyproxy.io/gatewayclass-controller</span>
<span class="w">  </span><span class="nt">parametersRef</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-config</span>
<span class="w">    </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyProxy</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gateway.networking.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Gateway</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-gateway</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gatewayClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-class</span>
<span class="w">  </span><span class="nt">listeners</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">    </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.gateway.envoyproxy.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EnvoyProxy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example-config</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">networkPublishing</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIPService</span>
</pre></div>
</div>
<p><strong>Note:</strong> The NetworkPublishing API is currently undefined and is provided here for illustration purposes only.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Envoy Gateway</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/compatibility.html">Compatibility Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_docs.html">User Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../design_docs.html">Design Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_docs.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about_docs.html">About the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_involved.html">Getting Involved</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../design_docs.html">Design Docs</a><ul>
      <li>Previous: <a href="watching.html" title="previous chapter">Watching Components Design</a></li>
      <li>Next: <a href="../dev_docs.html" title="next chapter">Developer Docs</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Envoy Gateway Project Authors | <a href="https://github.com/envoyproxy/gateway">GitHub</a> | <a href="/latest">Latest Docs</a>.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/design/config-api.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>