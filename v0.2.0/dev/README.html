
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Developer Guide &#8212; Envoy Gateway  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working on the Envoy Gateway Docs" href="DOCS.html" />
    <link rel="prev" title="Contributing" href="CONTRIBUTING.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Permalink to this heading">¶</a></h1>
<p>Envoy Gateway is built using a <a class="reference external" href="https://www.gnu.org/software/make/">make</a>-based build system. Our CI is based on <a class="reference external" href="https://docs.github.com/en/actions">Github Actions</a> using <a class="reference external" href="https://github.com/envoyproxy/gateway/tree/main/.github/workflows">workflows</a>.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h2>
<section id="go">
<h3>go<a class="headerlink" href="#go" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Version: 1.18.2</p></li>
<li><p>Installation Guide: https://go.dev/doc/install</p></li>
</ul>
</section>
<section id="make">
<h3>make<a class="headerlink" href="#make" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Recommended Version: 4.0 or later</p></li>
<li><p>Installation Guide: https://www.gnu.org/software/make</p></li>
</ul>
</section>
<section id="docker">
<h3>docker<a class="headerlink" href="#docker" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Optional when you want to build a Docker image or run <code class="docutils literal notranslate"><span class="pre">make</span></code> inside Docker.</p></li>
<li><p>Recommended Version: 20.10.16</p></li>
<li><p>Installation Guide: https://docs.docker.com/engine/install</p></li>
</ul>
</section>
<section id="python3">
<h3>python3<a class="headerlink" href="#python3" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Need a <code class="docutils literal notranslate"><span class="pre">python3</span></code> program</p></li>
<li><p>Must have a functioning <code class="docutils literal notranslate"><span class="pre">venv</span></code> module; this is part of the standard
library, but some distributions (such as Debian and Ubuntu) replace
it with a stub and require you to install a <code class="docutils literal notranslate"><span class="pre">python3-venv</span></code> package
separately.</p></li>
</ul>
</section>
</section>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">help</span></code> to see all the available targets to build, test and run Envoy Gateway.</p></li>
</ul>
<section id="building">
<h3>Building<a class="headerlink" href="#building" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">build</span></code> to build the Envoy Gateway binary. <strong>Note:</strong> The binary gets generated in the <code class="docutils literal notranslate"><span class="pre">bin/</span></code> directory</p></li>
</ul>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> to run the golang tests.</p></li>
</ul>
</section>
<section id="running-linters">
<h3>Running Linters<a class="headerlink" href="#running-linters" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">lint</span></code> to make sure your code passes all the linter checks.</p></li>
</ul>
</section>
<section id="building-and-pushing-the-image">
<h3>Building and Pushing the Image<a class="headerlink" href="#building-and-pushing-the-image" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">IMAGE=docker.io/you/gateway-dev</span> <span class="pre">make</span> <span class="pre">image</span></code> to build the docker image.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">IMAGE=docker.io/you/gateway-dev</span> <span class="pre">make</span> <span class="pre">push-multiarch</span></code> to build and push the multi-arch docker image.</p></li>
</ul>
<p><strong>Note:</strong>  Replace <code class="docutils literal notranslate"><span class="pre">IMAGE</span></code> with your registry’s image name.</p>
</section>
<section id="deploying-envoy-gateway-for-test-dev">
<h3>Deploying Envoy Gateway for Test/Dev<a class="headerlink" href="#deploying-envoy-gateway-for-test-dev" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">create-cluster</span></code> to create a <a class="reference external" href="https://kind.sigs.k8s.io/">Kind</a> cluster.</p></li>
</ul>
<section id="option-1-use-the-latest-gateway-dev-image">
<h4>Option 1: Use the Latest <a class="reference external" href="https://hub.docker.com/r/envoyproxy/gateway-dev/tags">gateway-dev</a> Image<a class="headerlink" href="#option-1-use-the-latest-gateway-dev-image" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">kube-deploy</span></code> to deploy Envoy Gateway in the Kind cluster using the latest image. Replace <code class="docutils literal notranslate"><span class="pre">latest</span></code>
to use a different image tag.</p></li>
</ul>
</section>
<section id="option-2-use-a-custom-image">
<h4>Option 2: Use a Custom Image<a class="headerlink" href="#option-2-use-a-custom-image" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-install-image</span></code> to build an image from the tip of your current branch and load it in the Kind cluster.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-deploy</span></code> to install Envoy Gateway into the Kind cluster using your custom image.</p></li>
</ul>
</section>
</section>
<section id="deploying-envoy-gateway-in-kubernetes">
<h3>Deploying Envoy Gateway in Kubernetes<a class="headerlink" href="#deploying-envoy-gateway-in-kubernetes" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">kube-deploy</span></code> to deploy Envoy Gateway using the latest image into a Kubernetes cluster (linked to
the current kube context). Preface the command with <code class="docutils literal notranslate"><span class="pre">IMAGE</span></code> or replace <code class="docutils literal notranslate"><span class="pre">TAG</span></code> to use a different Envoy Gateway image or
tag.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-undeploy</span></code> to uninstall Envoy Gateway from the cluster.</p></li>
</ul>
<p><strong>Note:</strong> Envoy Gateway is tested against Kubernetes v1.24.0.</p>
</section>
<section id="demo-setup">
<h3>Demo Setup<a class="headerlink" href="#demo-setup" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-demo</span></code> to deploy a demo backend service, gatewayclass, gateway and httproute resource
(similar to steps outlined in the <a class="reference external" href="https://github.com/envoyproxy/gateway/blob/main/docs/user/quickstart.md">Quickstart</a> docs) and test the configuration.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-demo-undeploy</span></code> to delete the resources created by the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-demo</span></code> command.</p></li>
</ul>
</section>
<section id="run-gateway-api-conformance-tests">
<h3>Run Gateway API Conformance Tests<a class="headerlink" href="#run-gateway-api-conformance-tests" title="Permalink to this heading">¶</a></h3>
<p>The commands below deploy Envoy Gateway to a Kubernetes cluster and run the Gateway API conformance tests. Refer to the
Gateway API <a class="reference external" href="https://gateway-api.sigs.k8s.io/concepts/conformance/">conformance homepage</a> to learn more about the tests. If Envoy Gateway is already installed, run
<code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">run-conformance</span></code> to run the conformance tests.</p>
<section id="on-a-linux-host">
<h4>On a Linux Host<a class="headerlink" href="#on-a-linux-host" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">conformance</span></code> to create a Kind cluster, install Envoy Gateway using the latest <a class="reference external" href="https://hub.docker.com/r/envoyproxy/gateway-dev/tags">gateway-dev</a>
image, and run Gateway API conformance tests.</p></li>
</ul>
</section>
<section id="on-a-mac-host">
<h4>On a Mac Host<a class="headerlink" href="#on-a-mac-host" title="Permalink to this heading">¶</a></h4>
<p>Since Mac doesn’t support <a class="reference external" href="https://kind.sigs.k8s.io/docs/user/loadbalancer/">directly exposing</a> the Docker network to the Mac host, use one of the following
workarounds to run conformance tests:</p>
<ul class="simple">
<li><p>Deploy your own Kubernetes cluster or use Docker Desktop with <a class="reference external" href="https://docs.docker.com/desktop/kubernetes/">Kubernetes support</a> and then run
<code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">kube-deploy</span> <span class="pre">run-conformance</span></code>. This will install Envoy Gateway using the latest <a class="reference external" href="https://hub.docker.com/r/envoyproxy/gateway-dev/tags">gateway-dev</a> image
to the Kubernetes cluster using the current kubectl context and run the conformance tests. Use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">kube-undeploy</span></code> to
uninstall Envoy Gateway.</p></li>
<li><p>Install and run <a class="reference external" href="https://github.com/chipmk/docker-mac-net-connect">Docker Mac Net Connect</a> and then run <code class="docutils literal notranslate"><span class="pre">TAG=latest</span> <span class="pre">make</span> <span class="pre">conformance</span></code>.</p></li>
</ul>
<p><strong>Note:</strong>  Preface commands with <code class="docutils literal notranslate"><span class="pre">IMAGE</span></code> or replace <code class="docutils literal notranslate"><span class="pre">TAG</span></code> to use a different Envoy Gateway image or tag. If <code class="docutils literal notranslate"><span class="pre">TAG</span></code>
is unspecified, the short SHA of your current branch is used.</p>
</section>
</section>
<section id="debugging-the-envoy-config">
<h3>Debugging the Envoy Config<a class="headerlink" href="#debugging-the-envoy-config" title="Permalink to this heading">¶</a></h3>
<p>An easy way to view the envoy config that Envoy Gateway is using is to port-forward to the admin interface port
(currently <code class="docutils literal notranslate"><span class="pre">19000</span></code>) on the Envoy deployment that corresponds to a Gateway so that it can be accessed locally.</p>
<p>Get the name of the Envoy deployment. The following example is for Gateway <code class="docutils literal notranslate"><span class="pre">eg</span></code> in the <code class="docutils literal notranslate"><span class="pre">default</span></code> namespace:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">ENVOY_DEPLOYMENT</span><span class="o">=</span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>deploy<span class="w"> </span>-n<span class="w"> </span>envoy-gateway-system<span class="w"> </span>--selector<span class="o">=</span>gateway.envoyproxy.io/owning-gateway-namespace<span class="o">=</span>default,gateway.envoyproxy.io/owning-gateway-name<span class="o">=</span>eg<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.items[0].metadata.name}&#39;</span><span class="k">)</span>
</pre></div>
</div>
<p>Port forward the admin interface port:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl<span class="w"> </span>port-forward<span class="w"> </span>deploy/<span class="si">${</span><span class="nv">ENVOY_DEPLOYMENT</span><span class="si">}</span><span class="w"> </span>-n<span class="w"> </span>envoy-gateway-system<span class="w"> </span><span class="m">19000</span>:19000
</pre></div>
</div>
<p>Now you are able to view the running Envoy configuration by navigating to <code class="docutils literal notranslate"><span class="pre">127.0.0.1:19000/config_dump</span></code>.</p>
<p>There are many other endpoints on the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/latest/operations/admin#operations-admin-interface">Envoy admin interface</a> that may be helpful when debugging.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Envoy Gateway</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/compatibility.html">Compatibility Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_docs.html">User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design_docs.html">Design Docs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../dev_docs.html">Developer Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about_docs.html">About the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_involved.html">Getting Involved</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../dev_docs.html">Developer Docs</a><ul>
      <li>Previous: <a href="CONTRIBUTING.html" title="previous chapter">Contributing</a></li>
      <li>Next: <a href="DOCS.html" title="next chapter">Working on the Envoy Gateway Docs</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Envoy Gateway Project Authors | <a href="https://github.com/envoyproxy/gateway">GitHub</a> | <a href="/latest">Latest Docs</a>.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/dev/README.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>